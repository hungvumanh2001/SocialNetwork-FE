{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Hp/IdeaProjects/SocialNetwork-FE/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { FormControl, FormGroup } from \"@angular/forms\";\nimport { finalize } from \"rxjs\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../service/status.service\";\nimport * as i2 from \"../../../service/image.service\";\nimport * as i3 from \"@angular/fire/compat/storage\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\n\nfunction StatusCreateComponent_img_42_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"img\", 44);\n    i0.ɵɵlistener(\"click\", function StatusCreateComponent_img_42_Template_img_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const i_r3 = restoredCtx.index;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.deleteImg(i_r3));\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const img_r2 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"src\", img_r2, i0.ɵɵsanitizeUrl);\n  }\n}\n\nexport let StatusCreateComponent = /*#__PURE__*/(() => {\n  class StatusCreateComponent {\n    constructor(statusService, imageService, storage, router) {\n      this.statusService = statusService;\n      this.imageService = imageService;\n      this.storage = storage;\n      this.router = router;\n      this.avatarCurrentUser = localStorage.getItem(\"AVATAR\");\n      this.selectedImages = [];\n      this.imgs = [];\n      this.statusForm = new FormGroup({\n        content: new FormControl(''),\n        status: new FormControl('')\n      });\n    }\n\n    ngOnInit() {}\n\n    submit() {\n      this.statuz = {\n        content: this.statusForm.value.content,\n        status: this.statusForm.value.status,\n        owner: {\n          id: localStorage.getItem('ID')\n        }\n      };\n\n      if (this.statuz.content == \"\" && this.imgs.length == 0) {} else {\n        if (this.statuz.status == 0) {\n          this.statuz.status = 1;\n        }\n\n        this.statusService.save(this.statuz).subscribe(data => {\n          for (let item of this.imgs) {\n            const images = {\n              status: {\n                id: data.id\n              },\n              image: item\n            };\n            this.imageService.save(images).subscribe(() => {});\n          }\n\n          this.statusForm.reset();\n          this.imgs = [];\n          this.reloadCurrentRoute();\n        }, error => {});\n      }\n    } // upload ảnh\n\n\n    upload() {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        if (_this.newSelectedImages.length !== 0) {\n          for (let i = 0; i < _this.newSelectedImages.length; i++) {\n            let selectedImage = _this.newSelectedImages[i];\n            var n = Date.now();\n            const filePath = `RoomsImages/${n}`;\n\n            const fileRef = _this.storage.ref(filePath);\n\n            yield _this.storage.upload(filePath, selectedImage).snapshotChanges().pipe(finalize(() => {\n              fileRef.getDownloadURL().subscribe(url => {\n                console.log(url);\n\n                _this.imgs.push(url);\n              });\n            })).subscribe(() => {});\n          }\n        }\n      })();\n    } // Chọn ảnh\n\n\n    selectFile(event) {\n      if (event.target.files && event.target.files[0]) {\n        const reader = new FileReader();\n        reader.readAsDataURL(event.target.files[0]);\n        this.newSelectedImages = event.target.files;\n\n        for (let i = 0; i < event.target.files.length; i++) {\n          this.selectedImages.push(event.target.files[i]);\n        }\n\n        this.upload();\n      } else {\n        this.selectedImages = [];\n      }\n    }\n\n    deleteImg(i) {\n      this.imgs.splice(i, 1);\n    }\n\n    reloadCurrentRoute() {\n      let currentUrl = this.router.url;\n      this.router.navigateByUrl('/', {\n        skipLocationChange: true\n      }).then(() => {\n        this.router.navigate([currentUrl]);\n      });\n    }\n\n  }\n\n  StatusCreateComponent.ɵfac = function StatusCreateComponent_Factory(t) {\n    return new (t || StatusCreateComponent)(i0.ɵɵdirectiveInject(i1.StatusService), i0.ɵɵdirectiveInject(i2.ImageService), i0.ɵɵdirectiveInject(i3.AngularFireStorage), i0.ɵɵdirectiveInject(i4.Router));\n  };\n\n  StatusCreateComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: StatusCreateComponent,\n    selectors: [[\"app-status-create\"]],\n    decls: 62,\n    vars: 4,\n    consts: [[1, \"card\", \"card-body\"], [1, \"d-flex\", \"mb-3\"], [1, \"avatar\", \"avatar-xs\", \"me-2\"], [\"href\", \"#\"], [\"alt\", \"\", 1, \"avatar-img\", \"rounded-circle\", 3, \"src\"], [1, \"w-100\"], [\"placeholder\", \"Chia s\\u1EBB nh\\u1EEFng suy ngh\\u0129 c\\u1EE7a b\\u1EA1n...\", \"data-bs-toggle\", \"modal\", \"data-bs-target\", \"#modalCreateFeed\", 1, \"form-control\", \"pe-4\", \"border-0\"], [1, \"nav\", \"nav-pills\", \"nav-stack\", \"small\", \"fw-normal\"], [1, \"nav-item\", \"dropdown\", \"ms-sm-auto\"], [\"aria-labelledby\", \"feedActionShare\", 1, \"dropdown-menu\", \"dropdown-menu-end\"], [\"href\", \"#\", 1, \"dropdown-item\"], [1, \"bi\", \"bi-envelope\", \"fa-fw\", \"pe-2\"], [1, \"bi\", \"bi-bookmark-check\", \"fa-fw\", \"pe-2\"], [1, \"dropdown-divider\"], [1, \"bi\", \"bi-pencil-square\", \"fa-fw\", \"pe-2\"], [\"id\", \"modalCreateFeed\", \"tabindex\", \"-1\", \"aria-labelledby\", \"modalLabelCreateFeed\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"modal-dialog\", \"modal-dialog-centered\", \"modal-dialog-scrollable\"], [1, \"modal-content\"], [1, \"modal-header\"], [\"id\", \"modalLabelCreateFeed\", 1, \"modal-title\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", \"aria-label\", \"Close\", 1, \"btn-close\"], [1, \"modal-body\"], [\"rows\", \"4\", \"placeholder\", \"Chia s\\u1EBB nh\\u1EEFng suy ngh\\u0129 c\\u1EE7a b\\u1EA1n...\", \"autofocus\", \"\", \"formControlName\", \"content\", 1, \"form-control\", \"pe-4\", \"fs-3\", \"lh-1\", \"border-0\"], [1, \"hstack\", \"gap-2\"], [1, \"card-body\", \"position-relative\", \"pt-0\"], [1, \"row\", \"g-2\"], [1, \"col-12\", 2, \"height\", \"150px\", \"overflow\", \"auto\"], [\"class\", \"rounded img-fluid col-4\", \"alt\", \"\", \"style\", \"height: 100%\", 3, \"src\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"custom-file\"], [\"type\", \"file\", \"id\", \"file\", \"multiple\", \"\", \"name\", \"image\", \"autocomplete\", \"off\", \"id\", \"inputGroupFile01\", \"accept\", \"image/png, image/gif, image/jpeg\", 1, \"custom-file-input\", 3, \"change\"], [\"userPhoto\", \"\"], [\"for\", \"inputGroupFile01\", 1, \"custom-file-label\"], [\"data-bs-toggle\", \"tooltip\", \"data-bs-placement\", \"top\", \"title\", \"Photo\", 1, \"icon-md\", \"bg-success\", \"bg-opacity-10\", \"text-success\", \"rounded-circle\"], [1, \"bi\", \"bi-image-fill\"], [1, \"overflow-auto\"], [1, \"modal-footer\", \"row\", \"justify-content-between\"], [1, \"col-lg-4\"], [\"data-position\", \"top\", \"data-search-enabled\", \"false\", \"formControlName\", \"status\", \"id\", \"selectStatus\", 1, \"form-select\", \"js-choice\"], [\"value\", \"1\", \"selected\", \"\"], [\"value\", \"2\"], [\"value\", \"3\"], [1, \"col-lg-7\", \"text-sm-end\"], [\"type\", \"submit\", \"data-bs-dismiss\", \"modal\", 1, \"btn\", \"btn-primary-soft\"], [\"alt\", \"\", 1, \"rounded\", \"img-fluid\", \"col-4\", 2, \"height\", \"100%\", 3, \"src\", \"click\"]],\n    template: function StatusCreateComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"a\", 3);\n        i0.ɵɵelement(4, \"img\", 4);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(5, \"form\", 5);\n        i0.ɵɵelement(6, \"input\", 6);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(7, \"ul\", 7)(8, \"li\", 8)(9, \"ul\", 9)(10, \"li\")(11, \"a\", 10);\n        i0.ɵɵelement(12, \"i\", 11);\n        i0.ɵɵtext(13, \"Create a poll\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"li\")(15, \"a\", 10);\n        i0.ɵɵelement(16, \"i\", 12);\n        i0.ɵɵtext(17, \"Ask a question \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(18, \"li\");\n        i0.ɵɵelement(19, \"hr\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"li\")(21, \"a\", 10);\n        i0.ɵɵelement(22, \"i\", 14);\n        i0.ɵɵtext(23, \"Help\");\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵelementStart(24, \"div\", 15)(25, \"form\", 16);\n        i0.ɵɵlistener(\"ngSubmit\", function StatusCreateComponent_Template_form_ngSubmit_25_listener() {\n          return ctx.submit();\n        });\n        i0.ɵɵelementStart(26, \"div\", 17)(27, \"div\", 18)(28, \"div\", 19)(29, \"h5\", 20);\n        i0.ɵɵtext(30, \"T\\u1EA1o b\\u00E0i \\u0111\\u0103ng\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(31, \"button\", 21);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"div\", 22)(33, \"div\", 1)(34, \"div\", 2);\n        i0.ɵɵelement(35, \"img\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(36, \"form\", 5);\n        i0.ɵɵelement(37, \"textarea\", 23);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(38, \"div\", 24)(39, \"div\", 25)(40, \"div\", 26)(41, \"div\", 27);\n        i0.ɵɵtemplate(42, StatusCreateComponent_img_42_Template, 1, 1, \"img\", 28);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(43, \"div\", 29)(44, \"input\", 30, 31);\n        i0.ɵɵlistener(\"change\", function StatusCreateComponent_Template_input_change_44_listener($event) {\n          return ctx.selectFile($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(46, \"label\", 32)(47, \"span\", 33);\n        i0.ɵɵelement(48, \"i\", 34);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelement(49, \"div\", 35);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(50, \"div\", 36)(51, \"div\", 37)(52, \"select\", 38)(53, \"option\", 39);\n        i0.ɵɵtext(54, \"C\\u00F4ng khai\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(55, \"option\", 40);\n        i0.ɵɵtext(56, \"Ch\\u1EC9 m\\u00ECnh t\\u00F4i\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(57, \"option\", 41);\n        i0.ɵɵtext(58, \"B\\u1EA1n b\\u00E8\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(59, \"div\", 42)(60, \"button\", 43);\n        i0.ɵɵtext(61, \"\\u0110\\u0103ng b\\u00E0i\");\n        i0.ɵɵelementEnd()()()()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵpropertyInterpolate(\"src\", ctx.avatarCurrentUser, i0.ɵɵsanitizeUrl);\n        i0.ɵɵadvance(21);\n        i0.ɵɵproperty(\"formGroup\", ctx.statusForm);\n        i0.ɵɵadvance(10);\n        i0.ɵɵpropertyInterpolate(\"src\", ctx.avatarCurrentUser, i0.ɵɵsanitizeUrl);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngForOf\", ctx.imgs);\n      }\n    },\n    dependencies: [i5.NgForOf, i6.ɵNgNoValidate, i6.NgSelectOption, i6.ɵNgSelectMultipleOption, i6.DefaultValueAccessor, i6.SelectControlValueAccessor, i6.NgControlStatus, i6.NgControlStatusGroup, i6.FormGroupDirective, i6.FormControlName],\n    styles: [\"#inputGroupFile01[_ngcontent-%COMP%]{display:none}\"]\n  });\n  return StatusCreateComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}