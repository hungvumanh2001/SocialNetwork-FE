{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Hp/IdeaProjects/SocialNetwork-FE/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { FormControl, FormGroup } from \"@angular/forms\";\nimport { finalize } from \"rxjs\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../service/status.service\";\nimport * as i2 from \"../../../service/image.service\";\nimport * as i3 from \"@angular/fire/compat/storage\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\n\nfunction StatusCreateComponent_img_42_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"img\", 44);\n    i0.ɵɵlistener(\"click\", function StatusCreateComponent_img_42_Template_img_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const i_r3 = restoredCtx.index;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.deleteImg(i_r3));\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const img_r2 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"src\", img_r2, i0.ɵɵsanitizeUrl);\n  }\n}\n\nexport class StatusCreateComponent {\n  constructor(statusService, imageService, storage, router) {\n    this.statusService = statusService;\n    this.imageService = imageService;\n    this.storage = storage;\n    this.router = router;\n    this.avatarCurrentUser = localStorage.getItem(\"AVATAR\");\n    this.selectedImages = [];\n    this.imgs = [];\n    this.statusForm = new FormGroup({\n      content: new FormControl(''),\n      status: new FormControl('')\n    });\n  }\n\n  ngOnInit() {}\n\n  submit() {\n    this.statuz = {\n      content: this.statusForm.value.content,\n      status: this.statusForm.value.status,\n      owner: {\n        id: localStorage.getItem('ID')\n      }\n    };\n\n    if (this.statuz.content == \"\" && this.imgs.length == 0) {} else {\n      if (this.statuz.status == 0) {\n        this.statuz.status = 1;\n      }\n\n      this.statusService.save(this.statuz).subscribe(data => {\n        for (let item of this.imgs) {\n          const images = {\n            status: {\n              id: data.id\n            },\n            image: item\n          };\n          this.imageService.save(images).subscribe(() => {});\n        }\n\n        this.statusForm.reset();\n        this.imgs = [];\n        this.reloadCurrentRoute();\n      }, error => {});\n    }\n\n    this.reloadCurrentRoute();\n  } // upload ảnh\n\n\n  upload() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this.newSelectedImages.length !== 0) {\n        for (let i = 0; i < _this.newSelectedImages.length; i++) {\n          let selectedImage = _this.newSelectedImages[i];\n          var n = Date.now();\n          const filePath = `RoomsImages/${n}`;\n\n          const fileRef = _this.storage.ref(filePath);\n\n          yield _this.storage.upload(filePath, selectedImage).snapshotChanges().pipe(finalize(() => {\n            fileRef.getDownloadURL().subscribe(url => {\n              console.log(url);\n\n              _this.imgs.push(url);\n            });\n          })).subscribe(() => {});\n        }\n      }\n    })();\n  } // Chọn ảnh\n\n\n  selectFile(event) {\n    if (event.target.files && event.target.files[0]) {\n      const reader = new FileReader();\n      reader.readAsDataURL(event.target.files[0]);\n      this.newSelectedImages = event.target.files;\n\n      for (let i = 0; i < event.target.files.length; i++) {\n        this.selectedImages.push(event.target.files[i]);\n      }\n\n      this.upload();\n    } else {\n      this.selectedImages = [];\n    }\n  }\n\n  deleteImg(i) {\n    this.imgs.splice(i, 1);\n  }\n\n  reloadCurrentRoute() {\n    let currentUrl = this.router.url;\n    this.router.navigateByUrl('/', {\n      skipLocationChange: true\n    }).then(() => {\n      this.router.navigate([currentUrl]);\n    });\n  }\n\n}\n\nStatusCreateComponent.ɵfac = function StatusCreateComponent_Factory(t) {\n  return new (t || StatusCreateComponent)(i0.ɵɵdirectiveInject(i1.StatusService), i0.ɵɵdirectiveInject(i2.ImageService), i0.ɵɵdirectiveInject(i3.AngularFireStorage), i0.ɵɵdirectiveInject(i4.Router));\n};\n\nStatusCreateComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: StatusCreateComponent,\n  selectors: [[\"app-status-create\"]],\n  decls: 62,\n  vars: 4,\n  consts: [[1, \"card\", \"card-body\"], [1, \"d-flex\", \"mb-3\"], [1, \"avatar\", \"avatar-xs\", \"me-2\"], [\"href\", \"#\"], [\"alt\", \"\", 1, \"avatar-img\", \"rounded-circle\", 3, \"src\"], [1, \"w-100\"], [\"placeholder\", \"Chia s\\u1EBB nh\\u1EEFng suy ngh\\u0129 c\\u1EE7a b\\u1EA1n...\", \"data-bs-toggle\", \"modal\", \"data-bs-target\", \"#modalCreateFeed\", 1, \"form-control\", \"pe-4\", \"border-0\"], [1, \"nav\", \"nav-pills\", \"nav-stack\", \"small\", \"fw-normal\"], [1, \"nav-item\", \"dropdown\", \"ms-sm-auto\"], [\"aria-labelledby\", \"feedActionShare\", 1, \"dropdown-menu\", \"dropdown-menu-end\"], [\"href\", \"#\", 1, \"dropdown-item\"], [1, \"bi\", \"bi-envelope\", \"fa-fw\", \"pe-2\"], [1, \"bi\", \"bi-bookmark-check\", \"fa-fw\", \"pe-2\"], [1, \"dropdown-divider\"], [1, \"bi\", \"bi-pencil-square\", \"fa-fw\", \"pe-2\"], [\"id\", \"modalCreateFeed\", \"tabindex\", \"-1\", \"aria-labelledby\", \"modalLabelCreateFeed\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"modal-dialog\", \"modal-dialog-centered\", \"modal-dialog-scrollable\"], [1, \"modal-content\"], [1, \"modal-header\"], [\"id\", \"modalLabelCreateFeed\", 1, \"modal-title\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", \"aria-label\", \"Close\", 1, \"btn-close\"], [1, \"modal-body\"], [\"rows\", \"4\", \"placeholder\", \"Chia s\\u1EBB nh\\u1EEFng suy ngh\\u0129 c\\u1EE7a b\\u1EA1n...\", \"autofocus\", \"\", \"formControlName\", \"content\", 1, \"form-control\", \"pe-4\", \"fs-3\", \"lh-1\", \"border-0\"], [1, \"hstack\", \"gap-2\"], [1, \"card-body\", \"position-relative\", \"pt-0\"], [1, \"row\", \"g-2\"], [1, \"col-12\", 2, \"height\", \"150px\", \"overflow\", \"auto\"], [\"class\", \"rounded img-fluid col-4\", \"alt\", \"\", \"style\", \"height: 100%\", 3, \"src\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"custom-file\"], [\"type\", \"file\", \"id\", \"file\", \"multiple\", \"\", \"name\", \"image\", \"autocomplete\", \"off\", \"id\", \"inputGroupFile01\", \"accept\", \"image/png, image/gif, image/jpeg\", 1, \"custom-file-input\", 3, \"change\"], [\"userPhoto\", \"\"], [\"for\", \"inputGroupFile01\", 1, \"custom-file-label\"], [\"data-bs-toggle\", \"tooltip\", \"data-bs-placement\", \"top\", \"title\", \"Photo\", 1, \"icon-md\", \"bg-success\", \"bg-opacity-10\", \"text-success\", \"rounded-circle\"], [1, \"bi\", \"bi-image-fill\"], [1, \"overflow-auto\"], [1, \"modal-footer\", \"row\", \"justify-content-between\"], [1, \"col-lg-4\"], [\"data-position\", \"top\", \"data-search-enabled\", \"false\", \"formControlName\", \"status\", \"id\", \"selectStatus\", 1, \"form-select\", \"js-choice\"], [\"value\", \"1\", \"selected\", \"\"], [\"value\", \"2\"], [\"value\", \"3\"], [1, \"col-lg-7\", \"text-sm-end\"], [\"type\", \"submit\", \"data-bs-dismiss\", \"modal\", 1, \"btn\", \"btn-primary-soft\"], [\"alt\", \"\", 1, \"rounded\", \"img-fluid\", \"col-4\", 2, \"height\", \"100%\", 3, \"src\", \"click\"]],\n  template: function StatusCreateComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"a\", 3);\n      i0.ɵɵelement(4, \"img\", 4);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(5, \"form\", 5);\n      i0.ɵɵelement(6, \"input\", 6);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(7, \"ul\", 7)(8, \"li\", 8)(9, \"ul\", 9)(10, \"li\")(11, \"a\", 10);\n      i0.ɵɵelement(12, \"i\", 11);\n      i0.ɵɵtext(13, \"Create a poll\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(14, \"li\")(15, \"a\", 10);\n      i0.ɵɵelement(16, \"i\", 12);\n      i0.ɵɵtext(17, \"Ask a question \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(18, \"li\");\n      i0.ɵɵelement(19, \"hr\", 13);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"li\")(21, \"a\", 10);\n      i0.ɵɵelement(22, \"i\", 14);\n      i0.ɵɵtext(23, \"Help\");\n      i0.ɵɵelementEnd()()()()()();\n      i0.ɵɵelementStart(24, \"div\", 15)(25, \"form\", 16);\n      i0.ɵɵlistener(\"ngSubmit\", function StatusCreateComponent_Template_form_ngSubmit_25_listener() {\n        return ctx.submit();\n      });\n      i0.ɵɵelementStart(26, \"div\", 17)(27, \"div\", 18)(28, \"div\", 19)(29, \"h5\", 20);\n      i0.ɵɵtext(30, \"T\\u1EA1o b\\u00E0i \\u0111\\u0103ng\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(31, \"button\", 21);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(32, \"div\", 22)(33, \"div\", 1)(34, \"div\", 2);\n      i0.ɵɵelement(35, \"img\", 4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(36, \"form\", 5);\n      i0.ɵɵelement(37, \"textarea\", 23);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(38, \"div\", 24)(39, \"div\", 25)(40, \"div\", 26)(41, \"div\", 27);\n      i0.ɵɵtemplate(42, StatusCreateComponent_img_42_Template, 1, 1, \"img\", 28);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(43, \"div\", 29)(44, \"input\", 30, 31);\n      i0.ɵɵlistener(\"change\", function StatusCreateComponent_Template_input_change_44_listener($event) {\n        return ctx.selectFile($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(46, \"label\", 32)(47, \"span\", 33);\n      i0.ɵɵelement(48, \"i\", 34);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelement(49, \"div\", 35);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(50, \"div\", 36)(51, \"div\", 37)(52, \"select\", 38)(53, \"option\", 39);\n      i0.ɵɵtext(54, \"C\\u00F4ng khai\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(55, \"option\", 40);\n      i0.ɵɵtext(56, \"Ch\\u1EC9 m\\u00ECnh t\\u00F4i\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(57, \"option\", 41);\n      i0.ɵɵtext(58, \"B\\u1EA1n b\\u00E8\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(59, \"div\", 42)(60, \"button\", 43);\n      i0.ɵɵtext(61, \"\\u0110\\u0103ng b\\u00E0i\");\n      i0.ɵɵelementEnd()()()()()()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(4);\n      i0.ɵɵpropertyInterpolate(\"src\", ctx.avatarCurrentUser, i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(21);\n      i0.ɵɵproperty(\"formGroup\", ctx.statusForm);\n      i0.ɵɵadvance(10);\n      i0.ɵɵpropertyInterpolate(\"src\", ctx.avatarCurrentUser, i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngForOf\", ctx.imgs);\n    }\n  },\n  dependencies: [i5.NgForOf, i6.ɵNgNoValidate, i6.NgSelectOption, i6.ɵNgSelectMultipleOption, i6.DefaultValueAccessor, i6.SelectControlValueAccessor, i6.NgControlStatus, i6.NgControlStatusGroup, i6.FormGroupDirective, i6.FormControlName],\n  styles: [\"#inputGroupFile01[_ngcontent-%COMP%]{\\r\\n  display: none;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0YXR1cy1jcmVhdGUuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxLQUFLO0FBQ0w7RUFDRSxhQUFhO0FBQ2YiLCJmaWxlIjoic3RhdHVzLWNyZWF0ZS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLyppZCovXHJcbiNpbnB1dEdyb3VwRmlsZTAxe1xyXG4gIGRpc3BsYXk6IG5vbmU7XHJcbn1cclxuXHJcbiJdfQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["FormControl","FormGroup","finalize","i0","StatusCreateComponent","constructor","statusService","imageService","storage","router","localStorage","getItem","content","status","ngOnInit","submit","statuz","statusForm","value","owner","id","imgs","length","save","subscribe","data","item","images","image","reset","reloadCurrentRoute","error","upload","newSelectedImages","i","selectedImage","n","Date","now","filePath","fileRef","ref","snapshotChanges","pipe","getDownloadURL","url","console","log","push","selectFile","event","target","files","reader","FileReader","readAsDataURL","selectedImages","deleteImg","splice","currentUrl","navigateByUrl","skipLocationChange","then","navigate","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\Hp\\IdeaProjects\\SocialNetwork-FE\\src\\app\\component\\status\\status-create\\status-create.component.ts","C:\\Users\\Hp\\IdeaProjects\\SocialNetwork-FE\\src\\app\\component\\status\\status-create\\status-create.component.html"],"sourcesContent":["import {Component, OnInit} from '@angular/core';\r\nimport {FormControl, FormGroup} from \"@angular/forms\";\r\nimport {StatusService} from \"../../../service/status.service\";\r\nimport {finalize, Observable} from \"rxjs\";\r\nimport {ImageService} from \"../../../service/image.service\";\r\nimport {AngularFireStorage} from \"@angular/fire/compat/storage\";\r\nimport {Router} from \"@angular/router\";\r\n\r\n@Component({\r\n  selector: 'app-status-create',\r\n  templateUrl: './status-create.component.html',\r\n  styleUrls: ['./status-create.component.css']\r\n})\r\nexport class StatusCreateComponent implements OnInit {\r\n  avatarCurrentUser = localStorage.getItem(\"AVATAR\")\r\n  statuz: any;\r\n  selectedImages: any[] = [];\r\n  imgs: string[] = [];\r\n  newSelectedImages: [];\r\n  fileInfos: Observable<any>;\r\n  statusForm: FormGroup = new FormGroup({\r\n    content: new FormControl(''),\r\n    status: new FormControl(''),\r\n  });\r\n\r\n  constructor(private statusService: StatusService,\r\n              private imageService: ImageService,\r\n              private storage: AngularFireStorage,\r\n              private router: Router) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  submit() {\r\n    this.statuz = {\r\n      content: this.statusForm.value.content,\r\n      status: this.statusForm.value.status,\r\n      owner: {\r\n        id: localStorage.getItem('ID'),\r\n      }\r\n    }\r\n    if (this.statuz.content == \"\" && this.imgs.length == 0) {\r\n    } else {\r\n      if (this.statuz.status == 0) {\r\n        this.statuz.status = 1\r\n      }\r\n      this.statusService.save(this.statuz).subscribe((data) => {\r\n        for (let item of this.imgs) {\r\n          const images = {\r\n            status: {\r\n              id: data.id\r\n            },\r\n            image: item\r\n          }\r\n          this.imageService.save(images).subscribe(() => {\r\n          });\r\n        }\r\n        this.statusForm.reset();\r\n        this.imgs = [];\r\n        this.reloadCurrentRoute();\r\n      }, error => {\r\n      });\r\n    }\r\n    this.reloadCurrentRoute();\r\n  }\r\n\r\n  // upload ảnh\r\n  async upload() {\r\n    if (this.newSelectedImages.length !== 0) {\r\n      for (let i = 0; i < this.newSelectedImages.length; i++) {\r\n        let selectedImage = this.newSelectedImages[i];\r\n        var n = Date.now();\r\n        const filePath = `RoomsImages/${n}`;\r\n        const fileRef = this.storage.ref(filePath);\r\n        await this.storage.upload(filePath, selectedImage).snapshotChanges().pipe(\r\n          finalize(() => {\r\n            fileRef.getDownloadURL().subscribe(url => {\r\n              console.log(url);\r\n              this.imgs.push(url);\r\n            });\r\n          })\r\n        ).subscribe(() => {\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  // Chọn ảnh\r\n  selectFile(event: any) {\r\n    if (event.target.files && event.target.files[0]) {\r\n      const reader = new FileReader();\r\n      reader.readAsDataURL(event.target.files[0]);\r\n      this.newSelectedImages = event.target.files;\r\n      for (let i = 0; i < event.target.files.length; i++) {\r\n        this.selectedImages.push(event.target.files[i]);\r\n      }\r\n      this.upload()\r\n    } else {\r\n      this.selectedImages = [];\r\n    }\r\n  }\r\n\r\n  deleteImg(i: any) {\r\n    this.imgs.splice(i, 1)\r\n  }\r\n\r\n  reloadCurrentRoute() {\r\n    let currentUrl = this.router.url;\r\n    this.router.navigateByUrl('/', {skipLocationChange: true}).then(() => {\r\n      this.router.navigate([currentUrl]);\r\n    });\r\n  }\r\n}\r\n","<div class=\"card card-body\">\r\n  <div class=\"d-flex mb-3\">\r\n    <!-- Avatar -->\r\n    <div class=\"avatar avatar-xs me-2\">\r\n      <a href=\"#\"> <img class=\"avatar-img rounded-circle\" src=\"{{avatarCurrentUser}}\" alt=\"\"> </a>\r\n    </div>\r\n    <!-- Post input -->\r\n    <form class=\"w-100\">\r\n      <input class=\"form-control pe-4 border-0\" placeholder=\"Chia sẻ những suy nghĩ của bạn...\" data-bs-toggle=\"modal\"\r\n             data-bs-target=\"#modalCreateFeed\">\r\n    </form>\r\n  </div>\r\n  <!-- Share feed toolbar START -->\r\n  <ul class=\"nav nav-pills nav-stack small fw-normal\">\r\n    <li class=\"nav-item dropdown ms-sm-auto\">\r\n      <ul class=\"dropdown-menu dropdown-menu-end\" aria-labelledby=\"feedActionShare\">\r\n        <li><a class=\"dropdown-item\" href=\"#\"> <i class=\"bi bi-envelope fa-fw pe-2\"></i>Create a poll</a></li>\r\n        <li><a class=\"dropdown-item\" href=\"#\"> <i class=\"bi bi-bookmark-check fa-fw pe-2\"></i>Ask a question </a></li>\r\n        <li>\r\n          <hr class=\"dropdown-divider\">\r\n        </li>\r\n        <li><a class=\"dropdown-item\" href=\"#\"> <i class=\"bi bi-pencil-square fa-fw pe-2\"></i>Help</a></li>\r\n      </ul>\r\n    </li>\r\n  </ul>\r\n  <!-- Share feed toolbar END -->\r\n</div>\r\n<!--  Modal create Feed START-->\r\n<div class=\"modal fade\" id=\"modalCreateFeed\" tabindex=\"-1\" aria-labelledby=\"modalLabelCreateFeed\" aria-hidden=\"true\">\r\n  <form [formGroup]=\"statusForm\" (ngSubmit)=\"submit()\">\r\n    <div class=\"modal-dialog modal-dialog-centered modal-dialog-scrollable\">\r\n      <div class=\"modal-content\">\r\n        <!-- Modal feed header START -->\r\n        <div class=\"modal-header\">\r\n          <h5 class=\"modal-title\" id=\"modalLabelCreateFeed\">Tạo bài đăng</h5>\r\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n        </div>\r\n        <!-- Modal feed header END -->\r\n        <!-- Modal feed body START -->\r\n        <div class=\"modal-body\">\r\n          <!-- Add Feed -->\r\n          <div class=\"d-flex mb-3\">\r\n            <!-- Avatar -->\r\n            <div class=\"avatar avatar-xs me-2\">\r\n              <img class=\"avatar-img rounded-circle\" src=\"{{avatarCurrentUser}}\" alt=\"\">\r\n            </div>\r\n            <!-- Feed box  -->\r\n            <form class=\"w-100\">\r\n              <textarea class=\"form-control pe-4 fs-3 lh-1 border-0\" rows=\"4\"\r\n                        placeholder=\"Chia sẻ những suy nghĩ của bạn...\" autofocus formControlName=\"content\"></textarea>\r\n            </form>\r\n          </div>\r\n          <!-- Feed rect START -->\r\n          <div class=\"hstack gap-2\">\r\n            <!--            image-->\r\n            <div class=\"card-body position-relative pt-0\">\r\n              <div class=\"row g-2\">\r\n                <!-- Photos item -->\r\n                <div class=\"col-12\" style=\"height: 150px; overflow: auto\">\r\n                  <img class=\"rounded img-fluid col-4\" *ngFor=\"let img of imgs;let i = index;\" src=\"{{img}}\" alt=\"\"\r\n                       style=\"height: 100%\" (click)=\"deleteImg(i)\">\r\n                  <!-- glightbox Albums left bar END  -->\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"custom-file\">\r\n            <input type=\"file\" id=\"file\"\r\n                   #userPhoto\r\n                   multiple\r\n                   (change)=\"selectFile($event)\"\r\n                   name=\"image\"\r\n                   autocomplete=\"off\" class=\"custom-file-input\" id=\"inputGroupFile01\"\r\n                   accept=\"image/png, image/gif, image/jpeg\">\r\n            <label class=\"custom-file-label\" for=\"inputGroupFile01\"><span\r\n              class=\"icon-md bg-success bg-opacity-10 text-success rounded-circle\" data-bs-toggle=\"tooltip\"\r\n              data-bs-placement=\"top\" title=\"Photo\"> <i class=\"bi bi-image-fill\"></i> </span></label>\r\n          </div>\r\n          <div class=\"overflow-auto\">\r\n\r\n          </div>\r\n          <!-- Feed rect END -->\r\n        </div>\r\n        <!-- Modal feed body END -->\r\n\r\n        <!-- Modal feed footer -->\r\n        <div class=\"modal-footer row justify-content-between\">\r\n          <!-- Select -->\r\n          <div class=\"col-lg-4\">\r\n            <select class=\"form-select js-choice\" data-position=\"top\" data-search-enabled=\"false\"\r\n                    formControlName=\"status\" id=\"selectStatus\">\r\n              <option value=\"1\" selected>Công khai</option>\r\n              <option value=\"2\">Chỉ mình tôi</option>\r\n              <option value=\"3\">Bạn bè</option>\r\n            </select>\r\n          </div>\r\n          <!-- Button -->\r\n          <div class=\"col-lg-7 text-sm-end\">\r\n            <button type=\"submit\" class=\"btn btn-primary-soft\" data-bs-dismiss=\"modal\">Đăng bài</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n"]},"metadata":{},"sourceType":"module"}